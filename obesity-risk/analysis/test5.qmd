---
title: "Prueba 5"
format: html
editor: visual
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
obesity <- read_csv("../data/obesity_level.csv")
source("../R/load_data.R")
```

## Género y Consumo de Vegetales

Conocer el tipo de valores de la frecuencia de consumo de vegetales

```{r}
unique(obesity$vegetable_consumption_frequency)[1:10]
```

Conocer el tipo de la variable consumo de vegetales

```{r}
class(obesity$vegetable_consumption_frequency)
```


Diagrama de caja que relaciona género con frecuencia de consumo de vegetales

```{r}
#| fig-width: 6
#| fig-height: 4
ggplot(obesity, aes(x = Gender, y = vegetable_consumption_frequency)) +
  geom_boxplot()
```

Diagrama de densidad que relaciona el consumo de vegetales con el género

```{r}
#| fig-width: 6
#| fig-height: 4
ggplot(obesity, aes(x = vegetable_consumption_frequency, 
                    color = Gender)) +
  geom_density(linewidth = 0.75)
```

NOTA: Aquí parece haber diferencias marcadas porque parece que lasmujeres comen más vegetales que los hombres.

Diagrama de dispersión que relaciona imc con frecuencia de consumo de vegetales por género

```{r}
#| fig-width: 6
#| fig-height: 4
ggplot(
  data = obesity,
  mapping = aes(x = vegetable_consumption_frequency, y = imc,
                color = Gender)
) +
  geom_point()
```

Facetar por consumo de vegetales e imc en relación facetado por género

```{r}
#| fig-width: 6
#| fig-height: 4
ggplot(obesity, aes(x = vegetable_consumption_frequency, y = imc)) +
  geom_point(aes(color = Gender)) +
  facet_wrap(~Gender)
```

NOTA: Parece que sí comen más vegetales los hombres y tienen un imc mayor

Facetar por consumo de vegetales e imc en relación y facetado por tipo de obesidad
```{r}
#| fig-width: 8
#| fig-height: 4
ggplot(obesity, aes(x = vegetable_consumption_frequency, y = imc)) +
  geom_point(aes(color = Gender)) +
  facet_wrap(~tipo_obesidad)
```

NOTA: Este facetado es muy importante porque muestra que en general los hombres llegan a tener mayor imc que las mujeres a pesar de que si comen muchos vegetales. Sin embargo las mujeres más obesas si comen muchos vegetales también. Parecería que los vegetales no les defiende contra la obesidad ni a hombres ni a mujeres


Agrupar por género y tipo de obesidad y resumir imc y consumo de vegetales

```{r}
obesity_by_gender_tipo <- obesity |>
  group_by(Gender, tipo_obesidad) |>
  summarize(
    avg_vegetable = 
      mean(vegetable_consumption_frequency, 
                         na.rm = TRUE),
    avg_imc = mean(imc, na.rm = TRUE),
    .groups = "drop"
  )
obesity_by_gender_tipo
```

NOTA: Esta tabla es muy interesante porque muestra que las mujeres y los hombres que más vegetales comen son los más obesos

Diagrama de dispersión que relaciona imc con frecuencia de consumo de vegetales, por tipo de obesidad

```{r}
#| fig-width: 6
#| fig-height: 4
  
ggplot(obesity_by_gender_tipo, aes(x = avg_imc, 
                                   y = avg_vegetable)) +
  geom_point(aes(color = tipo_obesidad))
```

Diagrama de dispersión que relaciona imc con frecuencia de consumo de vegetales, por tipo de obesidad y facetado por género

```{r}
ggplot(obesity_by_gender_tipo, aes(x = avg_imc, 
                                   y = avg_vegetable)) +
  geom_point(aes(color = tipo_obesidad)) +
  facet_wrap(~Gender)
```

NOTA:  Este gráfico es muy importante porque muestra que las mujeres y los hombres más obesos son los que más vegetales consumen. Entonces no necesariamente comer vegetales ayuda?
